function [tform, corners1, corners2] = init_register(vol1, vol2)
%REGISTER_VOLUMES  Calculates an affine transform to align two volumes.
%   [tform, corners1, corners2] = register_volumes(vol1, vol2) 
%   calculates an affine transform that maps the corners of vol1 to the 
%   corners of vol2.
%
%   Inputs:
%       vol1   - The first volume (3D array).
%       vol2   - The second volume (3D array).
%
%   Outputs:
%       tform    - The affine3d transformation object.
%       corners1 - The corner coordinates of vol1.
%       corners2 - The corner coordinates of vol2.

% Get the size of each volume
size1 = size(vol1);
size2 = size(vol2);

% Extract corner coordinates of each volume
corners1 = [1, 1, 1; ...
            size1(1), 1, 1; ...
            1, size1(2), 1; ...
            size1(1), size1(2), 1; ...
            1, 1, size1(3); ...
            size1(1), 1, size1(3); ...
            1, size1(2), size1(3); ...
            size1(1), size1(2), size1(3)];

corners2 = [1, 1, 1; ...
            size2(1), 1, 1; ...
            1, size2(2), 1; ...
            size2(1), size2(2), 1; ...
            1, 1, size2(3); ...
            size2(1), 1, size2(3); ...
            1, size2(2), size2(3); ...
            size2(1), size2(2), size2(3)];

% Estimate the affine transformation
tform = fitAffineTrans3D(corners1, corners2); 

end